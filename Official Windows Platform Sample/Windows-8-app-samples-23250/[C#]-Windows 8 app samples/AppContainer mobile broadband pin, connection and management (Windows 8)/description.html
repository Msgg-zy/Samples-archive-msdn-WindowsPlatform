<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:sprite;/Areas/Epx/Themes/Windows/Content:0&amp;amp;hashKey=71AE1851B6C794DEF5BD9BC8F835D0EE" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/47c63455-7231-44b0-b4ee-e4560979780cCombined.css,0:sprite,1:LinkList;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C91CC0BBB362C4840AF9553071016400" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>AppContainer mobile broadband pin, connection and management (Windows 8)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/dc4f56b3-224a-4dd7-a435-210da682eb66Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>AppContainer mobile broadband pin, connection and management (Windows 8)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Windows Runtime
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Networking
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Windows RT
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary Language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Last Updated</label>
                    <div id="LastUpdated">6/27/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/windowsapps/AppContainer-mobile-706fd6d5">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy Code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="mainSection">
<p>This sample shows how to use Windows&nbsp;8 Win32/COM Mobile Broadband APIs within the AppContainer.
</p>
<p>It demonstrates how to:</p>
<ul>
<li>use the <a href="http://msdn.microsoft.com/library/windows/apps/dd323117"><b>IMbnPinManager</b></a> and
<a href="http://msdn.microsoft.com/library/windows/apps/dd323109"><b>IMbnPin</b></a> APIs to retrieve the pin state and how to unlock it if it is locked.
</li><li>use the <a href="http://msdn.microsoft.com/library/windows/apps/dd430380"><b>IMbnConnectionManager</b></a> and
<a href="http://msdn.microsoft.com/library/windows/apps/dd430368"><b>IMbnConnection</b></a> APIs to issue a connection connect or disconnect.
</li><li>use the <a href="http://msdn.microsoft.com/library/windows/apps/hh780527"><b>IMbnDeviceServicesManager</b></a> and
<a href="http://msdn.microsoft.com/library/windows/apps/hh780509"><b>IMbnDeviceService</b></a> APIs to enumerate the phone book.
</li></ul>
<p></p>
<p>To obtain an evaluation copy of Windows&nbsp;8, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=241655">
Windows&nbsp;8</a>.</p>
<p>To obtain an evaluation copy of Microsoft Visual Studio&nbsp;2012, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=241656">
Visual Studio&nbsp;2012</a>.</p>
<h3><a id="related_topics"></a>Related topics</h3>
<dl><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd430368"><b>IMbnConnection</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd430368events"><b>IMbnConnectionEvents</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd430380"><b>IMbnConnectionManager</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh780509"><b>IMbnDeviceService</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh780509scontext"><b>IMbnDeviceServicesContext</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh780509sevents"><b>IMbnDeviceServicesEvents</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh780527"><b>IMbnDeviceServicesManager</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd430406"><b>IMbnInterface</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd430406manager"><b>IMbnInterfaceManager</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd323109"><b>IMbnPin</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd323109events"><b>IMbnPinEvents</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd323117"><b>IMbnPinManager</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd323117events"><b>IMbnPinManagerEvents</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/hh780556"><b>MBN_DEVICE_SERVICE</b></a>
</dt><dt><a href="http://msdn.microsoft.com/library/windows/apps/dd323226"><b>MBN_PIN_INFO</b></a>
</dt><dt><a href="http://go.microsoft.com/fwlink/p/?LinkID=227694">Windows 8 app samples</a>
</dt></dl>
<h3>Related technologies</h3>
<a href="http://msdn.microsoft.com/library/windows/apps/dd323271">Mobile Broadband</a>
<h3>Operating system requirements</h3>
<table>
<tbody>
<tr>
<th>Client</th>
<td><dt>Windows&nbsp;8 </dt></td>
</tr>
<tr>
<th>Server</th>
<td><dt>Windows Server&nbsp;2012 </dt></td>
</tr>
</tbody>
</table>
<h3>Build the sample</h3>
<p></p>
<ol>
<li>Start Visual Studio Express&nbsp;2012 for Windows&nbsp;8 and select <b>File</b> &gt; <b>
Open</b> &gt; <b>Project/Solution</b>. </li><li>Go to the directory in which you unzipped the sample. Go to the directory named for the sample, and double-click the Visual Studio Express&nbsp;2012 for Windows&nbsp;8 Solution (.sln) file.
</li><li>Press F7 or use <b>Build</b> &gt; <b>Build Solution</b> to build the sample. </li></ol>
<p></p>
<h3><a id="Incorporating_the_sample_into_hybrid_applications"></a><a id="incorporating_the_sample_into_hybrid_applications"></a><a id="INCORPORATING_THE_SAMPLE_INTO_HYBRID_APPLICATIONS"></a>Incorporating the sample into hybrid applications</h3>
<p>To use these APIs correctly in hybrid applications (Javascript and C#) that are marked as
<b>Any CPU Type</b>, the COM interop DLL must be created using a 64-bit version of the TLB Importer tool (tlbimp.exe). This avoids alignment issues introduced by the default version of the tool. The 64-bit version of the tool may be found at (for example: C:\Program
 Files (x86)\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\x64\TlbImp.exe) and should be used as follows:
</p>
<p>&quot;Tlbimp.exe &quot;C:\Program Files (x86)\Windows Kits\8.0\Lib\win8\um\x64\mbnapi.tlb&quot; /out:&lt;InteropName&gt;.dll /machine:agnostic&quot;</p>
<p>The generated interop DLL should then be referenced directly from the C# project in the solution.</p>
<p>If the 64-bit version of tlbimp.exe is not available, then the interop DLL may be created for each platform (x86, x64, arm) using the default version of the tlbimp.exe tool as provided below. The solution needs to be marked as platform-specific as well and
 separate packages need to be generated for x86 and arm (and x64 as needed).</p>
<p>For example: &quot;C:\Program Files\Microsoft SDKs\Windows\v8.0A\bin\NETFX 4.0 Tools\tlbimp.exe&quot; &quot;C:\Program Files\Windows Kits\8.0\Lib\win8\um\x86\mbnapi.tlb&quot; /out:&lt;InteropName&gt;.dll /machine:x86</p>
<h3>Run the sample</h3>
<p>To debug the app and then run it, press F5 or use <b>Debug</b> &gt; <b>Start Debugging</b>. To run the app without debugging, press Ctrl&#43;F5 or use
<b>Debug</b> &gt; <b>Start Without Debugging</b>.</p>
<p>The AppContainer Mobile Broadband sample accesses privileged APIs and requires a custom signed Mobile Broadband account metadata package that references this application or the application accessing the device in order to run. The application will display
 an <b>Access is Denied</b> error message if the metadata package doesn't explicitly grant permission to this application. For info about how to create device metadata packages, see the
<a href="http://go.microsoft.com/fwlink/p/?LinkId=242581">Windows 8 Device Apps for Mobile Network Operators</a> white paper.</p>
</div>

</div>


    </div>
</body>
</html>
